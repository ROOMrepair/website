<!--  {{ partial "page_navigate" (dict "context" . "prev" false)}} -->

<div class="page-div common-flex-layout">
	<!-- if not each page in a section is pure page we can't simply use prev/nextInsection -->
	{{ $current := .}}
	{{ $p := .Parent.Pages.ByWeight }}
	{{ $length := len $p }}


	<!-- find current page's section position -->
	{{ $curIndex := 0 }}
	{{ range $i, $p_sec := $p}}

	<!-- DEBUG <div style="position: relative ;z-index: 99;top:0;width: 100;height: 100;color: darkblue;">
		gparent_section {{ $p_sec }}
	</div> -->
	
	{{ if eq $p_sec $current}}
	{{ $curIndex = $i }}
	{{ end }}
	{{ end }}

	<!-- DEBUG <div style="position: relative ;z-index: 99;top:0;width: 100;height: 100;color: pink;">
		cur {{ $current }}
		{{ $curIndex }}
	</div> -->

	<!-- prev -->
	{{ if gt $curIndex 0}}
	{{ $prevPage := index $p (sub $curIndex 1) }}
	{{ partial "findLastInSection" $prevPage}}
	{{ else }}
	{{ partial "page_navigate" (dict "context" . "prev" true)}}
	{{ end }}


	<!-- next -->
	{{ if lt $curIndex (sub $length 1) }}
	{{ $nextPage := index $p (add $curIndex 1)}}
	{{ partial "findFirstInSection" $nextPage}}
	{{ else }}
	{{ partial "page_navigate" (dict "context" . "prev" false)}}
	{{ end }}

</div>